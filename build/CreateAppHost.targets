<Project>
  <PropertyGroup>
    <__DirectoryName Condition="'$(Engine)' == 'WindowsDX'">Windows</__DirectoryName>
    <__DirectoryName Condition="'$(Engine)' == 'WindowsGL' Or '$(Engine)' == 'UniversalGL'">OpenGL</__DirectoryName>
    <__DirectoryName Condition="'$(Engine)' == 'WindowsXNA'">XNA</__DirectoryName>
  </PropertyGroup>

  <PropertyGroup>
    <__RunAppHostPatcher>False</__RunAppHostPatcher>
    <__RunAppHostPatcher Condition="$(TargetFramework.Contains('-'))">True</__RunAppHostPatcher> <!-- .NET6 WinForms Windows specific -->
    <__RunAppHostPatcher Condition="'$(TargetFrameworkIdentifier)' != '.NETFramework' And '$(Engine)' == 'UniversalGL' And'$(RuntimeIdentifier)' != ''">True</__RunAppHostPatcher> <!-- .NET6 UniversalGL platform specific -->
    <__RunAppHostPatcher Condition="'$(BuildingInsideVisualStudio)' == 'true'">False</__RunAppHostPatcher>
  </PropertyGroup>

  <Target Name="PatchAppHost" AfterTargets="_CreateAppHost" Condition="'$(__RunAppHostPatcher)'">
    <Message Importance="high" Text="AppHostPatcher @(IntermediateAssembly->'%(FullPath)')"/>
    <CreateAppHost
        AppHostSourcePath="$(AppHostSourcePath)"
        AppHostDestinationPath="$(AppHostIntermediatePath)"
        AppBinaryName="Binaries/$(__DirectoryName)/$(AssemblyName)$(TargetExt)"
        IntermediateAssembly="@(IntermediateAssembly->'%(FullPath)')"
        WindowsGraphicalUserInterface="$(_UseWindowsGraphicalUserInterface)"
        Retries="$(CopyRetryCount)"
        RetryDelayMilliseconds="$(CopyRetryDelayMilliseconds)"
        EnableMacOSCodeSign="$(_EnableMacOSCodeSign)"/>
  </Target>
</Project>